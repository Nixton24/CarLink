<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Taller Mecánico - Dashboard</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>

  <style>
    body { background-color: #f1f3f6; }
    .card { border-radius: 10px; }
    h5 { font-weight: 600; }
    .tab-pane { margin-top: 20px; }
    .card-resumen { background: #fff3cd; }
    .card-vehiculo { background: #d1ecf1; }
    .card-servicio { background: #d4edda; }
  </style>
</head>
<body>

<div class="container my-5">

  <!-- LOGIN / REGISTRO -->
  <div id="authSection" class="card p-4 shadow-sm">
    <ul class="nav nav-tabs">
      <li class="nav-item"><button class="nav-link active" data-bs-target="#login" data-bs-toggle="tab">Login</button></li>
      <li class="nav-item"><button class="nav-link" data-bs-target="#register" data-bs-toggle="tab">Registro</button></li>
    </ul>

    <div class="tab-content mt-3">
      
      <!-- LOGIN -->
      <div class="tab-pane fade show active" id="login">
        <form id="loginForm" class="card p-4 shadow-sm">
          <h5 class="text-center">Iniciar Sesión</h5>
          <input type="email" id="loginEmail" class="form-control mb-3" placeholder="Correo" required>
          <input type="password" id="loginPass" class="form-control mb-3" placeholder="Contraseña" required>
          <button class="btn btn-success w-100">Iniciar Sesión</button>
        </form>
      </div>

      <!-- REGISTRO -->
      <div class="tab-pane fade" id="register">
        <form id="registerForm" class="card p-4 shadow-sm">
          <h5 class="text-center">Registrar Usuario</h5>
          <input type="email" id="regEmail" class="form-control mb-3" placeholder="Correo" required>
          <input type="password" id="regPass" class="form-control mb-3" placeholder="Contraseña" required>
          <button class="btn btn-primary w-100">Registrar</button>
        </form>
      </div>

    </div>
  </div>

  <!-- PANEL PRINCIPAL -->
  <div id="appSection" class="mt-4" style="display:none;">

    <div class="d-flex justify-content-between align-items-center mb-4">
      <h4 id="userPanel">Usuario:</h4>
      <button id="logoutBtn" class="btn btn-danger">Cerrar Sesión</button>
    </div>

    <!-- Indicadores superiores -->
    <div class="row mb-4">
      <div class="col-md-3"><div class="card card-resumen p-3 shadow-sm"><h6>Total Vehículos</h6><h3 id="totalVehiculos">0</h3></div></div>
      <div class="col-md-3"><div class="card card-servicio p-3 shadow-sm"><h6>Servicios Abiertos</h6><h3 id="serviciosAbiertos">0</h3></div></div>
      <div class="col-md-3"><div class="card card-servicio p-3 shadow-sm"><h6>Servicios Cerrados</h6><h3 id="serviciosCerrados">0</h3></div></div>
      <div class="col-md-3"><div class="card card-servicio p-3 shadow-sm"><h6>Ingresos Totales</h6><h3 id="ingresosTotales">$0</h3></div></div>
    </div>

    <!-- Pestañas -->
    <ul class="nav nav-tabs">
      <li class="nav-item"><button class="nav-link active" data-bs-target="#vehiculos" data-bs-toggle="tab">Registrar Vehículo</button></li>
      <li class="nav-item"><button class="nav-link" data-bs-target="#abrirServicio" data-bs-toggle="tab">Abrir Servicio</button></li>
      <li class="nav-item"><button class="nav-link" data-bs-target="#cerrarServicio" data-bs-toggle="tab">Cerrar Servicio</button></li>
      <li class="nav-item"><button class="nav-link" data-bs-target="#buscarVehiculo" data-bs-toggle="tab">Buscar Vehículo</button></li>
      <li class="nav-item"><button class="nav-link" data-bs-target="#graficas" data-bs-toggle="tab">Gráficas & Contabilidad</button></li>
      <li class="nav-item"><button class="nav-link" data-bs-target="#contabilidad" data-bs-toggle="tab">Contabilidad</button></li>
    </ul>

    <div class="tab-content mt-3">

      <!-- REGISTRAR VEHÍCULO -->
      <div class="tab-pane fade show active" id="vehiculos">
        <form id="registerVehicleForm" class="card card-vehiculo p-4 shadow-sm mb-4">
          <h5 class="text-center">Registrar Vehículo</h5>
          <div class="row g-3">
            <div class="col-md-6"><input type="text" id="vin" class="form-control" placeholder="VIN" required></div>
            <div class="col-md-6"><input type="text" id="placas" class="form-control" placeholder="Placas"></div>
            <div class="col-md-4"><input type="text" id="marca" class="form-control" placeholder="Marca"></div>
            <div class="col-md-4"><input type="text" id="modelo" class="form-control" placeholder="Modelo"></div>
            <div class="col-md-4"><input type="number" id="anio" class="form-control" placeholder="Año"></div>
          </div>
          <button class="btn btn-primary w-100 mt-3">Registrar Vehículo</button>
        </form>
      </div>

      <!-- ABRIR SERVICIO -->
      <div class="tab-pane fade" id="abrirServicio">
        <form id="openServiceForm" class="card p-4 shadow-sm mb-4">
          <h5 class="text-center">Abrir Servicio</h5>
          <div class="row g-3">
            <div class="col-md-6"><input type="text" id="vin_ingreso" class="form-control" placeholder="VIN" required></div>
            <div class="col-md-6"><input type="text" id="falla" class="form-control" placeholder="Falla" required></div>
          </div>
          <button class="btn btn-warning w-100 mt-3">Abrir Servicio</button>
        </form>
      </div>

      <!-- CERRAR SERVICIO -->
      <div class="tab-pane fade" id="cerrarServicio">
        <form id="closeServiceForm" class="card p-4 shadow-sm mb-4">
          <h5 class="text-center">Cerrar Servicio</h5>
          <div class="row g-3">
            <div class="col-md-4"><input type="text" id="vin_entrega" class="form-control" placeholder="VIN" required></div>
            <div class="col-md-4"><input type="text" id="ingresoId_entrega" class="form-control" placeholder="ID Ingreso" required></div>
            <div class="col-md-4"><input type="text" id="reparacion" class="form-control" placeholder="Reparación"></div>
            <div class="col-md-3"><input type="number" id="costo" class="form-control" placeholder="Costo"></div>
            <div class="col-md-3"><input type="number" id="garantiaDias" class="form-control" placeholder="Garantía (días)"></div>
            <div class="col-md-6"><input type="text" id="condiciones" class="form-control" placeholder="Condiciones"></div>
          </div>
          <button class="btn btn-success w-100 mt-3">Cerrar Servicio</button>
        </form>
      </div>

      <!-- BUSCAR VEHÍCULO -->
      <div class="tab-pane fade" id="buscarVehiculo">
        <form id="searchForm" class="card p-4 shadow-sm mb-3">
          <h5 class="text-center">Buscar Vehículo</h5>
          <div class="row g-3">
            <div class="col-md-8"><input type="text" id="vinBuscar" class="form-control" placeholder="VIN"></div>
            <div class="col-md-4"><button class="btn btn-info w-100">Buscar</button></div>
          </div>
        </form>
        <div id="vehiculoInfo" style="display:none;">
          <div id="infoGeneral"></div>
          <div id="historialList"></div>
        </div>
      </div>

      <!-- GRÁFICAS PRINCIPALES -->
      <div class="tab-pane fade" id="graficas">
        <div class="row">
          <div class="col-md-6 mb-4">
            <div class="card p-4 shadow-sm">
              <h5 class="text-center">Servicios Abiertos vs Cerrados</h5>
              <canvas id="chartServicios"></canvas>
            </div>
          </div>
          <div class="col-md-6 mb-4">
            <div class="card p-4 shadow-sm">
              <h5 class="text-center">Vehículos Registrados</h5>
              <canvas id="chartVehiculos"></canvas>
            </div>
          </div>
        </div>

        <div class="card p-4 shadow-sm">
          <h5 class="text-center">Contabilidad - Ingresos</h5>
          <ul id="ultimosIngresos"></ul>
        </div>
      </div>

      <!-- CONTABILIDAD -->
      <div class="tab-pane fade" id="contabilidad">
        <div class="card p-3 shadow-sm">
          <h5>Resumen Contable</h5>

          <div class="row g-3">
            <div class="col-md-3"><b>Total Vehículos:</b> <span id="totalVehiculosSmall">0</span></div>
            <div class="col-md-3"><b>Servicios Abiertos:</b> <span id="serviciosAbiertosSmall">0</span></div>
            <div class="col-md-3"><b>Servicios Cerrados:</b> <span id="serviciosCerradosSmall">0</span></div>
            <div class="col-md-3"><b>Ingresos Totales:</b> <span id="ingresosTotalesSmall">$0</span></div>
          </div>

          <div class="mt-3">
            <canvas id="chartServiciosSmall" style="max-height:300px;"></canvas>
            <canvas id="chartVehiculosSmall" style="max-height:300px;"></canvas>
          </div>

          <h6 class="mt-3">Últimos ingresos</h6>
          <ul id="ultimosIngresosSmall"></ul>

        </div>
      </div>

    </div>
  </div>

</div>

<!-- Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- App -->
<script type="module" src="app.js"></script>

</body>
</html>
